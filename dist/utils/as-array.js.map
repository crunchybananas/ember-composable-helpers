{"version":3,"file":"as-array.js","sources":["../../src/utils/as-array.js"],"sourcesContent":["import { isArray } from '@ember/array';\nimport EmberObject, { get } from '@ember/object';\n\nfunction isIterable(value) {\n  return Symbol.iterator in Object(value);\n}\n\n// from https://github.com/flexyford/ember-power-select/blob/78a5430c1ac89daf315d0801fd5201e444e82434/addon/components/power-select.ts\nfunction isArrayable(thing) {\n  return typeof thing.toArray === 'function';\n}\n\nfunction isPromiseLike(thing) {\n  return typeof thing.then === 'function';\n}\n\nfunction isPromiseProxyLike(thing) {\n  return isPromiseLike(thing) && Object.hasOwnProperty.call(thing, 'content');\n}\n\nfunction toExtendable(array) {\n  if (!Object.isExtensible(array)) {\n    return Array.from(array);\n  } else {\n    return array;\n  }\n}\n\nexport default function asArray(maybeArray) {\n  return toExtendable(_asArray(maybeArray));\n}\n\nfunction _asArray(maybeArray) {\n  if (typeof maybeArray === 'number') {\n    throw new Error('Numbers not supported as arrays [ember-composable-helpers]');\n  }\n  if (typeof maybeArray === 'string') {\n    return maybeArray.split('');\n  }\n  // for perf-reasons falling back to e-array, instead of using it first\n  if (Array.isArray(maybeArray)) {\n    return maybeArray;\n  } else if (isArray(maybeArray)) {\n    return maybeArray;\n  } else if (typeof maybeArray === 'object' && maybeArray === null) {\n    return [];\n  } else if (typeof maybeArray === 'undefined') {\n    return [];\n  } else if (maybeArray instanceof Set) {\n    return Array.from(maybeArray.values());\n  } else if (maybeArray instanceof Map) {\n    return Array.from(maybeArray.values());\n  } else if (maybeArray instanceof WeakMap) {\n    throw new Error('WeakMaps is not supported as arrays [ember-composable-helpers]');\n  } else if (maybeArray instanceof WeakSet) {\n    throw new Error('WeakSets is not supported as arrays [ember-composable-helpers]');\n  } if (typeof maybeArray === 'object') {\n    if (isPromiseProxyLike(maybeArray)) {\n      const content = get(maybeArray, 'content');\n      if (typeof content !== 'object' || content === null) {\n        throw new Error('Unknown content type in array-like object [ember-composable-helpers]');\n      }\n      if (isArrayable(content)) {\n        return content.toArray();\n      } else {\n        return _asArray(content);\n      }\n    }\n    if (isPromiseLike(maybeArray)) {\n      throw new Error('Promise-like objects is not supported as arrays [ember-composable-helpers]');\n    }\n    if (isArrayable(maybeArray)) {\n      return maybeArray.toArray();\n    }\n    if (maybeArray instanceof EmberObject) {\n      throw new Error('EmberObjects is not supported as arrays [ember-composable-helpers]')\n    }\n    return Array.from(Object.values(maybeArray));\n  }\n  if (!maybeArray) {\n    return [];\n  }\n  if (!isIterable(maybeArray)) {\n    throw new Error('Argument, passed as array is not iterable [ember-composable-helpers]');\n  }\n  return maybeArray;\n}\n"],"names":["isIterable","value","Symbol","iterator","Object","isArrayable","thing","toArray","isPromiseLike","then","isPromiseProxyLike","hasOwnProperty","call","toExtendable","array","isExtensible","Array","from","asArray","maybeArray","_asArray","Error","split","isArray","Set","values","Map","WeakMap","WeakSet","content","get","EmberObject"],"mappings":"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"}